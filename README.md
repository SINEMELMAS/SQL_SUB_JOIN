# SQL_SUB_JOIN
SET STATISTICS IO ON;
SELECT TOP 1 DATEPART(MONTH, DT.DATE_) AS MONTHS, 
 U.INVOICE_ID AS ID, 
(SELECT MIN(P.PRICE) FROM PRODUCT P  WHERE P.INVOICE_ID = U.INVOICE_ID) 
AS MIN_PRICE
FROM USERS U
INNER JOIN  DATE_TIME DT ON DT.INVOICE_ID = U.INVOICE_ID
GROUP BY  DATEPART(MONTH, DT.DATE_), U.INVOICE_ID
ORDER BY  MIN_PRICE ASC;
